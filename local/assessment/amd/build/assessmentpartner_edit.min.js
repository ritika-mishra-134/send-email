define(["jquery","core/ajax","core/str","sweetalert2","core/url","select2-js"],function(a,b,c,d,e){var f={dom:{main:null},variable:{dataTableReference:null,pattern:/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/},langs:{enterName:null,enterDescription:null,enterEmail:null,enterValidEmail:null,enterApiEndpoint:null,enterToken:null,updateSuccessFull:null,choose:null,validLogo:null},action:{getString:function(a,b){c.get_strings([{key:"namerequired",component:"local_assessment"},{key:"descrptionrequired",component:"local_assessment"},{key:"emailrequired",component:"local_assessment"},{key:"validemail",component:"local_assessment"},{key:"enterapiendpoint",component:"local_assessment"},{key:"entertoken",component:"local_assessment"},{key:"updatesuccessfull",component:"local_assessment"},{key:"choose",component:"local_assessment"},{key:"validlogo",component:"local_assessment"}]).then(function(c){f.langs.enterName=c[0],f.langs.enterDescription=c[1],f.langs.enterEmail=c[2],f.langs.enterValidEmail=c[3],f.langs.enterApiEndpoint=c[4],f.langs.enterToken=c[5],f.langs.updateSuccessFull=c[6],f.langs.choose=c[7],f.langs.validLogo=c[8],f.init(a,b)}).fail(function(){})},validation:function(){return""==f.dom.name.val().trim()?(f.dom.nameRequired.html(f.langs.enterName).css({color:"red"}),!1):""==f.dom.description.val().trim()?(f.dom.descriptionRequired.html(f.langs.enterDescription).css({color:"red"}),!1):""==f.dom.email.val().trim()?(f.dom.emailRequired.html(f.langs.enterEmail).css({color:"red"}),!1):1==f.dom.logo.files.length&&"image/png"!==f.dom.logo.files[0].type&&"image/jpeg"!==f.dom.logo.files[0].type?(f.dom.logoRequired.html(f.langs.validLogo).css({color:"red"}),!1):f.variable.pattern.test(f.dom.email.val().trim())?!(0!=f.dom.payment.val()&&""==f.dom.apiEndPoint.val()||0!=f.dom.payment.val()&&""==f.dom.token.val())||(""==f.dom.apiEndPoint.val()?(f.dom.apiRequired.html(f.langs.enterApiEndpoint).css({color:"red"}),!1):""!=f.dom.token.val().trim()||(f.dom.tokenRequired.html(f.langs.enterToken).css({color:"red"}),!1)):(f.dom.emailRequired.html(f.langs.enterValidEmail).css({color:"red"}),!1)},editPartner:function(a,c){var g=b.call([{methodname:"local_assessment_assessmentpartner_edit",args:{id:a,name:f.dom.name.val(),description:f.dom.description.val(),sso:0==f.dom.sso.val()?0:f.dom.sso.val(),payment:0==f.dom.payment.val()?0:f.dom.payment.val(),subpayment:0==f.dom.subPayment.val()?0:f.dom.subPayment.val(),email:f.dom.email.val().trim(),apiendpoint:f.dom.apiEndPoint.val(),apitoken:f.dom.token.val(),userid:c}}]);g[0].done(function(a){1==a.status&&(1==f.dom.logo.files.length?f.dom.mainForm.submit():d.fire({position:"center",icon:"success",title:f.langs.updateSuccessFull,showConfirmButton:!1,timer:1500}).then(function(){window.location.href=e.relativeUrl("local/assessment/assessmentpartner_list.php")}))}).fail(function(){})}},init:function(b,c){f.dom.main=a(document).find("#assessment_form"),f.dom.mainForm=a(document).find("#assesmentForm"),f.dom.nameRequired=f.dom.main.find("#nameRequired"),f.dom.descriptionRequired=f.dom.main.find("#descriptionRequired"),f.dom.emailRequired=f.dom.main.find("#emailRequired"),f.dom.apiRequired=f.dom.main.find("#apirequired"),f.dom.tokenRequired=f.dom.main.find("#tokenrequired"),f.dom.logoRequired=f.dom.main.find("#logoRequired"),f.dom.name=f.dom.main.find("#name"),f.dom.description=f.dom.main.find("#description"),f.dom.email=f.dom.main.find("#email"),f.dom.apiEndPoint=f.dom.main.find("#api_endponit"),f.dom.token=f.dom.main.find("#token"),f.dom.sso=f.dom.main.find("#sso"),f.dom.payment=f.dom.main.find("#payment"),f.dom.subPayment=f.dom.main.find("#subpayment"),f.dom.logo=f.dom.main.find("#logo")[0],0==f.dom.payment.val()?(f.dom.subPayment.val("").trigger("change"),f.dom.apiEndPoint.val(""),f.dom.token.val(""),f.dom.apiEndPoint.prop("disabled",!0),f.dom.token.prop("disabled",!0),f.dom.subPayment.prop("disabled",!0)):(f.dom.apiEndPoint.prop("disabled",!1),f.dom.token.prop("disabled",!1),f.dom.subPayment.prop("disabled",!1)),f.dom.main.on("click","#editbutton",function(a){a.preventDefault(),1==f.action.validation()&&f.action.editPartner(b,c)}),f.dom.sso.select2({placeholder:f.langs.choose,allowClear:!0}),f.dom.payment.select2({placeholder:f.langs.choose,allowClear:!0}),f.dom.subPayment.select2({placeholder:f.langs.choose,allowClear:!0}),f.dom.payment.on("change",function(){0==f.dom.payment.val()?(f.dom.subPayment.val("").trigger("change"),f.dom.apiEndPoint.val(""),f.dom.token.val(""),f.dom.apiEndPoint.prop("disabled",!0),f.dom.token.prop("disabled",!0),f.dom.subPayment.prop("disabled",!0)):(f.dom.apiEndPoint.prop("disabled",!1),f.dom.token.prop("disabled",!1),f.dom.subPayment.prop("disabled",!1))})}};return{init:f.action.getString}});